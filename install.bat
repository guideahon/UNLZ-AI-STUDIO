@echo off
setlocal

echo.
echo(                                                                                                     
echo(                                                                     ##                             
echo(                                                                    %%#####                          
echo(                                                             #####  %%########                       
echo(                                                          ########  %%###########%%                   
echo(                                                       ###########  %%##############                 
echo(                                                   %%##############  %%##################             
echo(                                                ##################  %%#####################          
echo(                                             #####################  %%########################       
echo(                                          ########################  %%###########################    
echo(                                       ###########################  %%###########################    
echo(                                       ###########################  %%########################       
echo(                                 ####    #########################  %%#####################          
echo(                                 ######%%     #####################  %%#################%%             
echo(                          #####  ##########    %%##################  %%###############                
echo(                      %%########  #############     ###############  %%###########%%                   
echo(                    ###########  ################     ############  %%########                       
echo(                ###############  ###################     #########  %%#####                          
echo(             ##################  ######################%%    %%#####   ##                             
echo(          #####################  #########################     ###                                  
echo(       ########################  ###########################                                        
echo(    ###########################  ##########################     ##                                  
echo(   ############################  #######################     ######                                 
echo(     ##########################  ####################     #########                                 
echo(        %%######################  #################     ############                                 
echo(           ####################  ##############     ###############                                 
echo(              #################  ###########    ###################                                 
echo(                  #############  #######     ######################                                 
echo(                     ##########  #####    #########################                                 
echo(                        #######        %%###########################                                 
echo(                           %%##%%        ############################                                 
echo(                                 ######   #########################                                 
echo(                                 ########%%   ######################                                 
echo(                                 ############   ###################                                 
echo(                                 ###############    ###############                                 
echo(                                 ##################    ############                                 
echo(                                 #####################    #########                                 
echo(                                 ########################%%   ######                                 
echo(                                 ###########################     #                                  
echo(                                 ############################   %%#                                  
echo(                                 ##########################  ######                                 
echo(                                 ######################%%  %%########                                 
echo(                                 ###################%%  ############                                 
echo(                                 ################   ###############                                 
echo(                                 #############   ##################                                 
echo(                                 ##########  ######################                                 
echo(                                 ######%%   ########################                                 
echo(                                  ###  ############################                                 
echo(                                       ############################                                 
echo(                                 ####%%    #########################                                 
echo(                                 ########   #######################                                 
echo(                                 ###########    ###################                                 
echo(                                 ##############    ################                                 
echo(                                 #################%%   #############                                 
echo(                                 ####################%%   ##########                                 
echo(                                 ########################   #######                                 
echo(                                 ###########################   ###    #                             
echo(                                 ############################        #####                          
echo(                                 ##########################%%   ####  #########                      
echo(                                 #######################   %%#######  ############                   
echo(                                 ####################    ##########  ###############                
echo(                                 #################   %%#############  ##################             
echo(                                 ##############   #################  #####################%%         
echo(                                 ##########%%   ####################  ########################       
echo(                                 ########   #######################  ############################   
echo(                                 %%###    ##########################  ############################   
echo(                                       ############################  #########################%%     
echo(                                  ###   %%##########################  ######################         
echo(                                  ######    #######################  ###################            
echo(                            ###   #########   %%####################  ################               
echo(                        #######   ############    #################  #############                  
echo(                      #########   ###############    %%#############  #########                      
echo(                  #############   ##################%%   ###########  #######                        
echo(               ################   ######################   ########  ###%%                           
echo(            ###################   #########################   #####                                 
echo(         ######################   ###########################                                       
echo(      #########################   ###########################                                       
echo(    ###########################   ########################                                          
echo(     ##########################   #####################                                             
echo(        #######################   #################                                                 
echo(           ####################   ##############                                                    
echo(              #################   ###########                                                       
echo(                  #############   #######%%                                                          
echo(                    %%##########   #####                                                             
echo(                        #######                                                                     
echo(                           ####                                                                     
echo(                                                                                                    
echo(                                                                                                    
echo.

echo [UNLZ AI Studio] Instalando dependencias...

where python >nul 2>&1
if errorlevel 1 (
  echo Python no encontrado. Instalalo y vuelve a ejecutar este script.
  exit /b 1
)

where pip >nul 2>&1
if errorlevel 1 (
  echo pip no encontrado. Instalalo y vuelve a ejecutar este script.
  exit /b 1
)

where winget >nul 2>&1
if errorlevel 0 (
  echo Instalando llama.cpp con winget...
  winget install llama.cpp
) else (
  echo winget no disponible. Omitiendo instalacion de llama.cpp.
)

echo Instalando dependencias Python...
python -m pip install -U fastapi uvicorn httpx psutil python-multipart faster-whisper ^
  lmdeploy huggingface_hub transformers accelerate pillow requests ^
  customtkinter flask flask-socketio SpeechRecognition pyaudio

echo Instalando PyTorch (CUDA 12.1)...
python -m pip install --index-url https://download.pytorch.org/whl/cu121 torch torchvision torchaudio

if exist "system\\web_ui\\package.json" (
  echo Instalando dependencias Web UI...
  pushd "system\\web_ui"
  call npm install
  popd
) else (
  echo No se encontro system\\web_ui\\package.json. Omitiendo npm install.
)

echo Listo.
endlocal
